<!--
elevata – Metadata-driven Data Platform Framework
Copyright © 2025 Ilona Tag
SPDX-License-Identifier: AGPL-3.0-only
-->
{% extends "base.html" %}
{% load attr %}

{% block title %}{{ title }} · elevata{% endblock %}

{% block content %}
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 mb-0">{{ title }}</h1>

    {# Inline-create: inject a new row form at the top of the grid #}
    <button class="btn btn-primary"
            hx-get="{% url model_name|add:'_row_new' %}"
            hx-target="#grid-body"
            hx-swap="afterbegin">
      Add
    </button>
  </div>

  <table class="table table-striped table-hover align-middle">
    <thead class="table-light">
      <tr>
        {% for f in fields %}
          <th scope="col">{{ f.verbose_name|capfirst }}</th>
        {% endfor %}
        <th scope="col" class="text-end">Actions</th>
      </tr>
    </thead>

    <tbody id="grid-body">
      {# Render one display row per object; each row is HTMX-swappable #}
      {% for obj in objects %}
        {% include "generic/row.html" with object=obj model=model meta=meta fields=fields model_name=model_name %}
      {% empty %}
        <tr>
          <td colspan="99" class="text-center text-muted py-4">No records found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
