<!--
elevata - Metadata-driven Data Platform Framework
Copyright © 2025 Ilona Tag

This file is part of elevata.

elevata is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of
the License, or (at your option) any later version.

elevata is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with elevata. If not, see <https://www.gnu.org/licenses/>.

Contact: <https://github.com/elevata-labs/elevata>.
-->

{% extends "base.html" %}
{% load attr %}

{% block title %}{{ title }} · elevata{% endblock %}

{% block content %}
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 mb-0">{{ title }}</h1>

    {# Inline-create: inject a new row form at the top of the grid #}
    <button class="btn btn-primary"
            hx-get="{% url model_name|add:'_row_new' %}"
            hx-target="#grid-body"
            hx-swap="afterbegin">
      Add
    </button>
  </div>

  <table class="table table-striped table-hover align-middle">
    <thead class="table-light">
      <tr>
        {% for f in fields %}
          <th scope="col">{{ f.verbose_name|capfirst }}</th>
        {% endfor %}
        <th scope="col" class="text-end">Actions</th>
      </tr>
    </thead>

    <tbody id="grid-body">
      {# Render one display row per object; each row is HTMX-swappable #}
      {% for obj in objects %}
        {% include "generic/row.html" with object=obj model=model meta=meta fields=fields model_name=model_name %}
      {% empty %}
        <tr>
          <td colspan="99" class="text-center text-muted py-4">No records found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
